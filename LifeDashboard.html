<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Life Dashboard ‚Äî Fitness OS v6</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700;800&family=IBM+Plex+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--bg0:#08080a;--bg1:#0e0e12;--bg2:#141418;--bg3:#1a1a20;--bg4:#222228;--b1:#1e1e24;--t0:#f4f4f6;--t1:#c8c8d0;--t2:#8888a0;--t3:#55556a;--lime:#b8f000;--blue:#5b9df5;--orange:#f5a623;--red:#f55353;--green:#34d399;--purple:#a78bfa;--cyan:#22d3ee;--pink:#f472b6}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'DM Sans',sans-serif;background:var(--bg0);color:var(--t0);min-height:100vh;overflow-x:hidden}
#root{min-height:100vh}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:var(--bg1)}::-webkit-scrollbar-thumb{background:var(--bg4);border-radius:3px}
textarea{font-family:inherit;resize:vertical}select{-webkit-appearance:none;appearance:none}
input[type=number]::-webkit-inner-spin-button{opacity:1}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
.sidebar{width:210px;min-height:100vh;background:var(--bg1);border-right:1px solid var(--b1);padding:20px 0;display:flex;flex-direction:column;position:fixed;left:0;top:0;bottom:0;z-index:10}
.main{margin-left:210px;flex:1;padding:24px 28px;min-height:100vh}
.mob-bar{display:none;position:fixed;bottom:0;left:0;right:0;background:var(--bg1);border-top:1px solid var(--b1);z-index:20;padding:6px 0 max(6px,env(safe-area-inset-bottom))}
.mob-btn{display:none;position:fixed;top:14px;left:14px;z-index:15;background:var(--bg1);border:1px solid var(--b1);border-radius:8px;padding:8px 12px;color:var(--t0);font-size:1.1rem;cursor:pointer}
.sidebar-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:9}
@media(max-width:768px){
.sidebar{transform:translateX(-100%);transition:transform 0.3s ease;z-index:20}
.sidebar.open{transform:translateX(0)}
.sidebar-overlay.open{display:block;z-index:19}
.main{margin-left:0;padding:16px 12px;padding-bottom:80px;padding-top:56px}
.mob-bar{display:flex;justify-content:space-around;align-items:center}
.mob-btn{display:block}
}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const{useState,useEffect,useCallback}=React;
const uid=()=>"_"+Math.random().toString(36).slice(2,8);
const fmtD=d=>d.toISOString().split("T")[0];
const todayS=()=>fmtD(new Date());
const DOWS=["Lun","Mar","Mi√©","Jue","Vie","S√°b","Dom"];
const KEY="life-dashboard";

/* === DEFAULTS === */
const DEF_DT=[
{id:"dt1",name:"Descanso",emoji:" üò¥ ",color:"#a78bfa",cal:2250,prot:170,carbs:220,fat:65,sugar:40,calMin:2250,calMax:2350},
{id:"dt2",name:"Pesas",emoji:" üèãÔ∏è ",color:"#b8f000",cal:2250,prot:180,carbs:260,fat:65,sugar:40,calMin:2250,calMax:2350},
{id:"dt3",name:"Tenis/Padel",emoji:" üéæ ",color:"#5b9df5",cal:2250,prot:170,carbs:260,fat:65,sugar:40,calMin:2250,calMax:2350},
{id:"dt4",name:"Golf",emoji:" ‚õ≥ ",color:"#34d399",cal:2250,prot:160,carbs:240,fat:65,sugar:40,calMin:2250,calMax:2350},
{id:"dt5",name:"Pesas+Tenis/Padel",emoji:" üí™üéæ ",color:"#22d3ee",cal:2500,prot:180,carbs:280,fat:70,sugar:40,calMin:2500,calMax:2600},
{id:"dt6",name:"Pesas+Golf",emoji:" üí™‚õ≥ ",color:"#f5a623",cal:2750,prot:180,carbs:300,fat:70,sugar:40,calMin:2750,calMax:2850}];
const DEF_S={planName:"Mini-Cut 6 Semanas",planGoal:"20% ‚Üí 15% Body Fat",startWeight:73.7,goalWeight:71.0,startWaist:87.5,cutWeeks:6,startDate:"2026-02-01",trainingPerWeek:5,protRange:[153,999],fatRange:[0,75],carbRange:[0,999],sugarRange:[0,40]};
const DEF_HAB=[
{id:"h1",name:"Gym / Pesas",emoji:" üí™ ",meta:"5x/semana",active:true},
{id:"h2",name:"Lectura",emoji:" üìñ ",meta:"30 min/d√≠a",active:true},
{id:"h3",name:"P√°del / Tenis",emoji:" üéæ ",meta:"2x/semana",active:true},
{id:"h4",name:"Estudiar",emoji:" üß† ",meta:"1 hora/d√≠a",active:true},
{id:"h5",name:"Agua 3L",emoji:" üíß ",meta:"Diario",active:true},
{id:"h6",name:"Dormir 7h+",emoji:" üò¥ ",meta:"Diario",active:true}];
const DEF_HOR=[
{hour:"6:00",slots:["","Gym  üí™ ","","Gym  üí™ ","","Gym  üí™ ",""]},
{hour:"7:00",slots:["Gym  üí™ ","","Gym  üí™ ","","Gym  üí™ ","",""]},
{hour:"8:00",slots:["","","","","","P√°del  üéæ ",""]},
{hour:"9:00",slots:["Deep Work","Deep Work","Deep Work","Deep Work","Deep Work","",""]},
{hour:"10:00",slots:["Deep Work","Deep Work","Deep Work","Deep Work","Deep Work","",""]},
{hour:"11:00",slots:["Reuniones","","Reuniones","","Reuniones","",""]},
{hour:"12:00",slots:["Almuerzo  üçΩÔ∏è ","Almuerzo  üçΩÔ∏è ","Almuerzo  üçΩÔ∏è ","Almuerzo  üçΩÔ∏è ","Almuerzo  üçΩÔ∏è ","",""]},
{hour:"14:00",slots:["Proyectos  üíº ","Proyectos  üíº ","Proyectos  üíº ","Proyectos  üíº ","Proyectos  üíº ","",""]},
{hour:"16:00",slots:["Estudiar  üìö ","","Estudiar  üìö ","","Estudiar  üìö ","",""]},
{hour:"17:00",slots:["","Tenis  üéæ ","","","","",""]},
{hour:"19:00",slots:["Lectura  üìñ ","Lectura  üìñ ","Lectura  üìñ ","Lectura  üìñ ","Lectura  üìñ ","",""]},
{hour:"21:00",slots:["Descanso  üò¥ ","Descanso  üò¥ ","Descanso  üò¥ ","Descanso  üò¥ ","Descanso  üò¥ ","Libre  ‚ú® ","Libre  ‚ú® "]}];

// --- COMPONENTES AUXILIARES ESTABLES (FUERA DE LAS P√ÅGINAS) ---

const HabitRow = ({ h, wk, hw, toggle, updateHabit, deleteHabit, C, z }) => (
  <tr>
    <td style={{...z.td, minWidth:160}}>
      <div style={{display:"flex", alignItems:"center", gap:8}}>
        <span style={{fontSize:"1.1rem"}}>{h.emoji}</span>
        <input 
          style={{background:"transparent", border:"none", color:C.t1, fontSize:"0.76rem", width:"100%"}} 
          value={h.name} 
          onChange={e => updateHabit(h.id, 'name', e.target.value)}
        />
        <button onClick={() => deleteHabit(h.id)} style={{background:"none", border:"none", color:C.red, opacity:0.3, cursor:"pointer"}}>‚úï</button>
      </div>
    </td>
    {wk.map(dt => {
      const active = hw[`${dt}_${h.id}`];
      return (
        <td key={dt} style={{...z.td, textAlign:"center"}}>
          <div 
            onClick={() => toggle(dt, h.id)}
            style={{
              width:20, height:20, borderRadius:5, margin:"0 auto", cursor:"pointer",
              background: active ? C.lime : C.bg3,
              border: `1px solid ${active ? C.lime : C.b1}`,
              display:"flex", alignItems:"center", justifyContent:"center", color:C.bg0, fontSize:"0.6rem"
            }}
          >
            {active && "‚úì"}
          </div>
        </td>
      );
    })}
  </tr>
);

const ScheduleSlot = ({ hourIdx, dayIdx, value, update, C, z }) => (
  <td style={{...z.td, padding:0}}>
    <textarea 
      style={{
        width:"100%", background:"transparent", border:"none", color:C.t1, 
        fontSize:"0.65rem", padding:6, display:"block", textAlign:"center", minHeight:40
      }}
      value={value}
      onChange={e => update(hourIdx, dayIdx, e.target.value)}
    />
  </td>
);

/* === APP PRINCIPAL === */
function App(){
const[D,setD]=useState(null);const[ld,setLd]=useState(true);const[pg,setPg]=useState("dashboard");const[sideOpen,setSideOpen]=useState(false);
const C={bg0:"#08080a",bg1:"#0e0e12",bg2:"#141418",bg3:"#1a1a20",bg4:"#222228",b1:"#1e1e24",t0:"#f4f4f6",t1:"#c8c8d0",t2:"#8888a0",t3:"#55556a",lime:"#b8f000",blue:"#5b9df5",orange:"#f5a623",red:"#f55353",green:"#34d399",purple:"#a78bfa",cyan:"#22d3ee",pink:"#f472b6"};
const z={
  card:{background:C.bg1,border:`1px solid ${C.b1}`,borderRadius:14,padding:"16px",marginBottom:14},
  lb:{fontSize:"0.6rem",textTransform:"uppercase",letterSpacing:2,color:C.t3,fontWeight:600,marginBottom:8},
  td:{padding:"6px 4px",fontSize:"0.76rem",borderBottom:`1px solid ${C.b1}`},
  inp:{width:"100%",padding:"9px 14px",borderRadius:8,border:`1px solid ${C.b1}`,background:C.bg0,color:C.t0,fontSize:"0.82rem",fontFamily:"inherit",outline:"none"},
  btn:p=>({padding:"8px 16px",borderRadius:8,border:p?"none":`1px solid ${C.b1}`,fontWeight:600,fontSize:"0.78rem",cursor:"pointer",background:p?C.lime:C.bg2,color:p?C.bg0:C.t1})
};

useEffect(()=>{
  const s=localStorage.getItem(KEY);
  if(s) setD(JSON.parse(s)); else setD({settings:DEF_S, habits:DEF_HAB, habitWeekly:{}, horario:DEF_HOR});
  setLd(false);
},[]);

const sv=nd=>{setD(nd); localStorage.setItem(KEY,JSON.stringify(nd))};
if(!D) return null;

const HabitsPage = () => {
  const wk = []; const now = new Date(); const dow = now.getDay();
  const sow = new Date(now); sow.setDate(now.getDate()-(dow===0?6:dow-1));
  for(let i=0;i<7;i++){ const d=new Date(sow); d.setDate(sow.getDate()+i); wk.push(fmtD(d)) }

  const toggle = (dt, id) => {
    const n = {...D.habitWeekly}; const k = `${dt}_${id}`;
    if(n[k]) delete n[k]; else n[k]=true;
    sv({...D, habitWeekly:n});
  };

  const updateHabit = (id, field, val) => {
    const nh = D.habits.map(h => h.id === id ? {...h, [field]: val} : h);
    sv({...D, habits: nh});
  };

  const deleteHabit = id => {
    if(confirm("¬øBorrar?")) sv({...D, habits: D.habits.filter(h => h.id !== id)});
  };

  return (
    <div style={{animation:"fadeIn 0.3s ease-out"}}>
      <div style={{display:"flex", justifyContent:"space-between", marginBottom:20}}>
        <h2 style={{fontSize:"1.3rem"}}>üéØ H√°bitos Semanales</h2>
        <button style={z.btn(true)} onClick={() => sv({...D, habits:[...D.habits, {id:uid(), name:"Nuevo", emoji:"‚ú®", active:true}]})}>+ H√°bito</button>
      </div>
      <div style={z.card}>
        <table style={{width:"100%", borderCollapse:"collapse"}}>
          <thead>
            <tr>
              <th style={{textAlign:"left", paddingBottom:10, color:C.t3, fontSize:"0.6rem"}}>H√ÅBITO</th>
              {DOWS.map(d => <th key={d} style={{fontSize:"0.6rem", color:C.t3}}>{d}</th>)}
            </tr>
          </thead>
          <tbody>
            {D.habits.map(h => (
              <HabitRow key={h.id} h={h} wk={wk} hw={D.habitWeekly} toggle={toggle} updateHabit={updateHabit} deleteHabit={deleteHabit} C={C} z={z} />
            ))}
          </tbody>
        </table>
      </div>
    </div>
  );
};

const HorarioPage = () => {
  const updateSlot = (hIdx, dIdx, val) => {
    const nh = [...D.horario]; nh[hIdx].slots[dIdx] = val;
    sv({...D, horario: nh});
  };

  return (
    <div style={{animation:"fadeIn 0.3s ease-out"}}>
      <h2 style={{fontSize:"1.3rem", marginBottom:20}}>üìÖ Horario Maestro</h2>
      <div style={{...z.card, padding:0, overflowX:"auto"}}>
        <table style={{width:"100%", borderCollapse:"collapse", tableLayout:"fixed", minWidth:800}}>
          <thead>
            <tr>
              <th style={{...z.td, width:60, color:C.t3, fontSize:"0.6rem"}}>HORA</th>
              {DOWS.map(d => <th key={d} style={{...z.td, color:C.lime, fontSize:"0.6rem", textAlign:"center"}}>{d}</th>)}
            </tr>
          </thead>
          <tbody>
            {D.horario.map((row, hIdx) => (
              <tr key={hIdx}>
                <td style={{...z.td, textAlign:"center", fontWeight:700, fontSize:"0.65rem", color:C.t2}}>{row.hour}</td>
                {row.slots.map((s, dIdx) => (
                  <ScheduleSlot key={dIdx} hourIdx={hIdx} dayIdx={dIdx} value={s} update={updateSlot} C={C} z={z} />
                ))}
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>
  );
};

return (
  <div style={{display:"flex"}}>
    <div className={`sidebar ${sideOpen?'open':''}`}>
      <div style={{padding:"0 20px 20px", fontSize:"0.9rem", fontWeight:800, color:C.lime}}>FITNESS OS v6</div>
      <div style={{padding:"0 10px", flex:1}}>
        <div onClick={()=>setPg("dashboard")} style={{padding:10, cursor:"pointer", color:pg==="dashboard"?C.lime:C.t2}}>Dashboard</div>
        <div onClick={()=>setPg("habits")} style={{padding:10, cursor:"pointer", color:pg==="habits"?C.lime:C.t2}}>H√°bitos</div>
        <div onClick={()=>setPg("horario")} style={{padding:10, cursor:"pointer", color:pg==="horario"?C.lime:C.t2}}>Horario</div>
      </div>
    </div>
    <div className="main">
      <div className="mob-btn" onClick={()=>setSideOpen(true)}>‚ò∞</div>
      {pg==="habits" && <HabitsPage />}
      {pg==="horario" && <HorarioPage />}
      {pg==="dashboard" && <div><h2>Dashboard</h2><p style={{color:C.t3, marginTop:10}}>Selecciona una pesta√±a en el men√∫.</p></div>}
    </div>
    <div className={`sidebar-overlay ${sideOpen?'open':''}`} onClick={()=>setSideOpen(false)}></div>
  </div>
);
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);
</script>
</body>
</html>
